<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Ferramentas para Contadores</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bibliotecas externas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    * {
      box-sizing: border-box;
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #f4f7fa;
      color: #2c3e50;
    }

    header {
      background-color: #2c3e50;
      padding: 20px 40px;
      color: white;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 10;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    header h1 {
      margin: 0;
      font-size: 24px;
      display: inline-block;
    }

    nav {
      float: right;
    }

    nav a {
      color: white;
      text-decoration: none;
      margin-left: 30px;
      font-weight: bold;
      transition: color 0.3s;
    }

    nav a:hover {
      color: #1abc9c;
    }

    main {
      padding: 120px 40px 40px 40px;
      max-width: 1000px;
      margin: auto;
    }

    section {
      margin-bottom: 60px;
    }

    h2 {
      font-size: 26px;
      margin-bottom: 10px;
      border-bottom: 2px solid #3498db;
      display: inline-block;
      padding-bottom: 5px;
    }

    input[type="file"] {
      margin-top: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      cursor: pointer;
      width: 100%;
    }

    .card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      padding: 20px;
      margin-top: 20px;
    }

    .result {
      margin-top: 20px;
      padding: 15px;
      background: #ecf0f1;
      border-left: 5px solid #3498db;
      border-radius: 6px;
    }

    footer {
      text-align: center;
      padding: 30px 20px;
      background-color: #2c3e50;
      color: white;
    }

    .highlight { font-weight: bold; }
    .canceladas { color: #e74c3c; }
    .homologadas { color: #27ae60; }

    ul {
      padding-left: 20px;
    }

    @media (max-width: 700px) {
      nav { float: none; margin-top: 10px; text-align: center; }
      nav a { display: block; margin: 10px 0; }
    }
  </style>
</head>
<body>

  <header>
    <h1>üîß Ferramentas Cont√°beis</h1>
    <nav>
      <a href="#ferramentas">Ferramentas</a>
      <a href="#servicos">Servi√ßos</a>
      <a href="#sobre">Sobre N√≥s</a>
      <a href="#contato">Contato</a>
    </nav>
  </header>

  <main>

    <section id="ferramentas">
      <h2>üõ†Ô∏è Ferramentas</h2>

      <div class="card">
        <h3>üì¶ Contar Arquivos XML no ZIP</h3>
        <input type="file" id="zipInput" accept=".zip">
        <div id="resultadoZip" class="result"></div>
      </div>

      <div class="card">
        <h3>üìä Ler Excel de Notas Fiscais</h3>
        <p>üìå Notas iniciam em <strong>I3</strong>, valores em <strong>N3</strong>, status em <strong>S3</strong>.</p>
        <input type="file" id="excelInput" accept=".xlsx, .xls">
        <div id="resultadoExcel" class="result"></div>
      </div>
    </section>

    <section id="servicos">
      <h2>üíº Servi√ßos</h2>
      <div class="card">
        <p>Oferecemos ferramentas automatizadas para auxiliar na leitura e confer√™ncia de documentos fiscais como NF-e, SPEDs, DANFE e relat√≥rios de escritura√ß√£o.</p>
      </div>
    </section>

    <section id="sobre">
      <h2>üßæ Sobre N√≥s</h2>
      <div class="card">
        <p>Somos uma equipe apaixonada por contabilidade e tecnologia, com o objetivo de simplificar o dia a dia dos contadores atrav√©s de solu√ß√µes digitais acess√≠veis.</p>
      </div>
    </section>

    <section id="contato">
      <h2>üìû Contato</h2>
      <div class="card">
        <p>üìß Email: contato@ferramentascontabeis.com.br</p>
        <p>üì± WhatsApp: (11) 99999-9999</p>
      </div>
    </section>

  </main>

  <footer>
    &copy; 2025 Ferramentas Cont√°beis | Desenvolvido com üíô para contadores
  </footer>

  <script>
    // === ZIP ===
    document.getElementById('zipInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const resultadoDiv = document.getElementById('resultadoZip');

      if (!file) {
        resultadoDiv.textContent = "Nenhum arquivo selecionado.";
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        JSZip.loadAsync(e.target.result).then(function(zip) {
          let count = 0;
          zip.forEach(function (_, zipEntry) {
            if (zipEntry.name.toLowerCase().endsWith(".xml")) {
              count++;
            }
          });
          resultadoDiv.innerHTML = `<p>Total de arquivos XML: <span class="highlight">${count}</span></p>`;
        }).catch(function(err) {
          resultadoDiv.textContent = "Erro ao ler o ZIP: " + err;
        });
      };
      reader.readAsArrayBuffer(file);
    });

    // === EXCEL ===
    document.getElementById('excelInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const resultadoDiv = document.getElementById('resultadoExcel');

      if (!file) {
        resultadoDiv.textContent = "Nenhum arquivo selecionado.";
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];

        let row = 3;
        let totalNotas = 0;
        let somaValores = 0;
        let canceladas = [];

        while (true) {
          const notaCell = sheet[`I${row}`];
          const valorCell = sheet[`N${row}`];
          const statusCell = sheet[`S${row}`];

          if (!notaCell || !notaCell.v) break;

          totalNotas++;
          const valor = parseFloat(valorCell?.v || 0);
          somaValores += isNaN(valor) ? 0 : valor;

          const status = statusCell?.v || "";
          if (status.includes("Cancelamento de NF-e homologado")) {
            canceladas.push(notaCell.v);
          }

          row++;
        }

        const homologadas = totalNotas - canceladas.length;
        const diferenca = homologadas - canceladas.length;

        let html = `
          <p>üìÑ Total de notas: <span class="highlight">${totalNotas}</span></p>
          <p>üí∞ Valor total: <span class="highlight">R$ ${somaValores.toFixed(2).replace('.', ',')}</span></p>
          <p class="canceladas">‚ùå Canceladas: ${canceladas.length}</p>
          <p class="homologadas">‚úÖ Homologadas: ${homologadas}</p>
          <p>üìâ Diferen√ßa: <strong>${diferenca}</strong></p>
        `;

        if (canceladas.length > 0) {
          html += `<ul>` + canceladas.map(n => `<li>Nota cancelada: ${n}</li>`).join('') + `</ul>`;
        }

        resultadoDiv.innerHTML = html;
      };

      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>
